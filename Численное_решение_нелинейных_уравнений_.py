# -*- coding: utf-8 -*-
"""ÐšÐ¾Ð¿Ð¸Ñ Ð±Ð»Ð¾ÐºÐ½Ð¾Ñ‚Ð° "2. Ð§Ð¸ÑÐ»ÐµÐ½Ð½Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð½ÐµÐ»Ð¸Ð½ÐµÐ¹Ð½Ñ‹Ñ… ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ð¹"

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1fiND5GSAx1Yh1Sd6Q1iitZhjJxSomoSo

# Ð§Ð¸ÑÐ»ÐµÐ½Ð½Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð½ÐµÐ»Ð¸Ð½ÐµÐ¹Ð½Ñ‹Ñ… ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ð¹

## ÐŸÐ¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð´Ð°Ñ‡Ð¸
Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ 3 Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ:
* Ð¸ÑÐºÐ¾Ð¼Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ $x$
* ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¹, Ð·Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¾Ð½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾
* ÑÐ¿Ð¸ÑÐ¾Ðº Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ $x$ Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸
"""

def bisection(f, a, b, eps = 10e-9):
  x = 0
  n = 0
  x_list = []

  fa, fb = f(a), f(b)
  while b - a > 2 * eps:
    n += 1
    x = (a + b) / 2
    x_list.append(x)
    fx = f(x)
    if fa * fx < 0:
      b = x
      fb = fx
    elif fb * fx < 0:
      a = x
      fa = fx
    else:
      break

  return x, n, x_list


import math
def f(x):
  return math.exp(2*x) * math.sin(x) - math.cos(x)

"""Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ `matplotlib` Ð¿Ð¾ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Ð³Ñ€Ð°Ñ„Ð¸Ðº Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ $f(x)$"""

import matplotlib
import matplotlib.pyplot as plt
import numpy as np

plt.rcParams['figure.figsize'] = [12, 8]

funk = np.vectorize(f)

fig, ax = plt.subplots()
xx = np.arange(-1, 1, 0.001)
yy = funk(xx)
ax.plot(xx, yy, 'b')
ax.axhline(y = 0, color = 'k')
plt.show()

"""ÐŸÐ¾ Ð³Ñ€Ð°Ñ„Ð¸ÐºÑƒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ¸ $[a, b]$, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼ Ð¿Ñ€Ð¸Ð½Ð°Ð´Ð»ÐµÐ¶Ð°Ñ‚ ÐºÐ¾Ñ€Ð½Ð¸ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð½Ð° ÐºÐ¾Ð½Ñ†Ð°Ñ… Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ¾Ð² Ð¸Ð¼ÐµÑŽÑ‚ Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð·Ð½Ð°ÐºÐ¸."""

a1 = -1.8
b1 = -1.4
print(f(a1)*f(b1) < 0)

a2 = 0
b2 = 1
print(f(a2)*f(b2) < 0)

"""Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Ñ€Ð°Ð½ÐµÐµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ `bisection` Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚Ðµ Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð¾ 9 Ð·Ð½Ð°ÐºÐ¾Ð² Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹ ÐºÐ¾Ñ€Ð½Ð¸ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ Ð½Ð° Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð½Ð° Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¼ ÑˆÐ°Ð³Ðµ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ°Ñ…"""

x1, _, _ = bisection(f, a1, b1) 
x2, _, _ = bisection(f, a2, b2)

[x1, x2]

"""Ð¡Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ, Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ð² Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ $f(x)$ Ð´Ð»Ñ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ¾Ñ€Ð½ÐµÐ¹. ÐŸÐ¾ÐºÐ°Ð¶Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð±Ð»Ð¸Ð·ÐºÐ¸ Ðº Ð½ÑƒÐ»ÑŽ."""

print(f(x1))
print(f(x2))

"""#### Ð˜Ð·ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð¾Ð´Ð° Ð´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ð¿Ð¾Ð¿Ð¾Ð»Ð°Ð¼

Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ `matplotlib` Ð°Ð½Ð¸Ð¼Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð¼ÐµÑ‚Ð¾Ð´Ð° Ð´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ð¿Ð¾Ð¿Ð¾Ð»Ð°Ð¼ Ð´Ð»Ñ Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¸Ð· ÐºÐ¾Ñ€Ð½ÐµÐ¹ Ð¸ Ð¿Ñ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚.

Ð”Ð»Ñ Ð½Ð°Ð³Ð»ÑÐ´Ð½Ð¾ÑÑ‚Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð´Ð¾ Ñ‚Ñ€ÐµÑ‚ÑŒÐµÐ³Ð¾ Ð·Ð½Ð°ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹)
"""

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np

from matplotlib import rc
rc('animation', html='jshtml')

plt.rcParams['figure.figsize'] = [12, 8]

a = a1
b = b1
_, n, x_list = bisection(f, a, b, 10e-3)

fig, ax = plt.subplots()

ax.axhline(y = 0, color = 'k')

ax.plot([a, a], [0, f(a)], 'r:')
ax.plot([b, b], [0, f(b)], 'r:')

# Ð’Ð°Ñˆ ÐºÐ¾Ð´ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð½Ð° Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐµ [a, b] Ñ ÑˆÐ°Ð³Ð¾Ð¼ 0.01 
xx = np.arange(-1, 1, 0.01)
yy = funk(xx)
ax.plot(xx, yy, 'b')
ax.axhline(y = 0, color = 'k')
plt.show()
# ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚Ðµ ÐµÐ³Ð¾ ÑÐ¸Ð½Ð¸Ð¼ Ñ†Ð²ÐµÑ‚Ð¾Ð¼ ('b')

def animate(i):
  """
  Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ animate Ñ€Ð¸ÑÑƒÐµÑ‚ Ñ‚Ð¾Ñ‡ÐºÑƒ Ð½Ð° Ð³Ñ€Ð°Ñ„Ð¸ÐºÐµ, Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð½ÑƒÑŽ Ð² Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸
  """
  x_i = x_list[i] # Ð’Ð°ÑˆÐµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð° i-Ð¹ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸
  f_i = f(x_i)
  ax.plot([x_i, x_i], [0, f_i], 'r:')
  ax.plot(x_i, f_i, 'ro')

animation.FuncAnimation(fig, animate, frames=n)

"""##  ÐœÐµÑ‚Ð¾Ð´ ÑÐµÐºÑƒÑ‰Ð¸Ñ…

Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ 3 Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ:
* Ð¸ÑÐºÐ¾Ð¼Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ $x$
* ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¹, Ð·Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¾Ð½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾
* ÑÐ¿Ð¸ÑÐ¾Ðº Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ $x$ Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸
"""

def secant(f, x1, x2, eps=10e-9, max_iter=100):
  x = 0
  n = 0
  x_list = [x1, x2]
  f1 = f(x1)
  f2 = f(x2)

  while abs(x2-x1) > eps and n < max_iter:
    n+= 1
    x = (x1 * f2 - x2* f1) / (f2 - f1)
    x_list.append(x)
    x1, x2 = x2, x
    f1, f2 = f2, f(x)

  return x, n, x_list

"""#### Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÑÐµÐºÑƒÑ‰ÐµÐ¹

Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Ñ€Ð°Ð½ÐµÐµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ `secant` Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚Ðµ Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð¾ 9 Ð·Ð½Ð°ÐºÐ¾Ð² Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹ ÐºÐ¾Ñ€Ð½Ð¸ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ Ð½Ð° Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ°Ñ…, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð° Ð¼ÐµÑ‚Ð¾Ð´Ðµ Ð´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ð¿Ð¾Ð¿Ð¾Ð»Ð°Ð¼
"""

x1, _, _ = secant(f, a1, b1) 
x2, _, _ = secant(f, a2, b2)

[x1, x2]

"""Ð¡Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ, Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ð² Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ $f(x)$ Ð´Ð»Ñ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ¾Ñ€Ð½ÐµÐ¹. ÐŸÐ¾ÐºÐ°Ð¶Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð±Ð»Ð¸Ð·ÐºÐ¸ Ðº Ð½ÑƒÐ»ÑŽ."""

f(x1)
f(x2)

"""#### Ð˜Ð·ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÑÐµÐºÑƒÑ‰ÐµÐ¹

Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÐºÐ¾Ð´ Ð¸Ð· ÑÑ‡ÐµÐ¹ÐºÐ¸ Ð½Ð¸Ð¶Ðµ. ÐŸÑ€Ð¸ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð¹ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ `secant` Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚ÑÑ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÑÐµÐºÑƒÑ‰ÐµÐ¹.

ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÑÐµÐºÑƒÑ‰ÐµÐ¹ Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ð¾.
"""

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np

from matplotlib import rc
rc('animation', html='jshtml')
plt.rcParams['figure.figsize'] = [12, 8]

a = a1
b = b1
_, n, x_list = secant(f, a, b, 10e-3)

fig, ax = plt.subplots()

ax.axhline(y = 0, color = 'k')
ax.plot([a, a], [0, f(a)], 'r:')
ax.plot([b, b], [0, f(b)], 'r:')

xx = np.arange(a, b, 10e-4)
yy = np.vectorize(f)(xx)
ax.plot(xx, yy, 'b')

def animate(i):
  """
  Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ animate Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ñ€Ð¸ÑÑƒÐµÑ‚ Ñ…Ð¾Ñ€Ð´Ñƒ Ð¸ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ð¾Ðµ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ðµ
  """
  i += 2 # Ð¿Ñ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 2, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¾Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð´Ð²Ð° Ð·Ð°Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ñ
  x1, x2 = x_list[i - 2 : i]
  ax.plot([x1, x2, x_list[i]], [f(x1), f(x2), 0], 'r') # Ñ€Ð¸ÑÑƒÐµÐ¼ Ñ…Ð¾Ñ€Ð´Ñƒ
  ax.plot([x_list[i], x_list[i]], [0, f(x_list[i])], 'r:')
  ax.plot(x_list[i], f(x_list[i]), 'ro')

animation.FuncAnimation(fig, animate, frames=n)

"""## ÐœÐµÑ‚Ð¾Ð´ ÐÑŒÑŽÑ‚Ð¾Ð½Ð° (Ð¼ÐµÑ‚Ð¾Ð´ ÐºÐ°ÑÐ°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…)

Ð ÐµÐ°Ð»Ð¸Ð·ÑƒÐ¹Ñ‚Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ `newton(f, df, x0, eps, max_iter)`, Ð½Ð°Ñ…Ð¾Ð´ÑÑŽÑ‰ÑƒÑŽ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð½ÐµÐ»Ð¸Ð½ÐµÐ¹Ð½Ð¾Ð³Ð¾ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ $ð‘“(ð‘¥)=0$ c Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸ $x_1$ Ð¸ $x_2$ Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ $\epsilon$ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÑÐµÐºÑƒÑ‰ÐµÐ¹.

ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸: 
* `f` - Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‚ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ‡Ð¸ÑÐ»Ð¾Ð²Ð¾Ð³Ð¾ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð°;
* `df` - Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ, Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÑŽÑ‰Ð°Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ $f(x)$ Ð² Ñ‚Ð¾Ñ‡ÐºÐµ;
* `x0` - Ð¿ÐµÑ€Ð²Ð¾Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ðµ;
* `eps` - Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ.

Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ 3 Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ:
* Ð¸ÑÐºÐ¾Ð¼Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ $x$;
* ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¹, Ð·Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¾Ð½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾;
* ÑÐ¿Ð¸ÑÐ¾Ðº Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ $x$ Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸.
"""

def newton(f, df, x0, eps=10e-9, max_iter=100):
  x = x0 + f(x0) / df(x0)
  n = 1
  x_list = [x0, x]
  # Ð’Ð°ÑˆÐ° Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÐÑŒÑŽÑ‚Ð¾Ð½Ð°
  while abs(x - x0) > eps and n < max_iter:
    n += 1
    x0 = x
    x = x0 + f(x0) / df(x0)
    x_list.append(x)

  return x, n, x_list

"""#### Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÐÑŒÑŽÑ‚Ð¾Ð½Ð°

Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ SymPy Ð½Ð°Ð¹Ð´Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ $f(x)$ Ð´Ð»Ñ ÑÐ²Ð¾ÐµÐ³Ð¾ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð°.
"""

from sympy import *

x = symbols('x')

# Ð’Ð°ÑˆÐ° Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð½Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð² ÑÐ¸Ð¼Ð²Ð¾Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ð¸Ð´Ðµ
# Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚Ðµ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ df_expr
x = symbols('x')
f_expr = exp(2*x) * sin(x) - cos(x)
df_expr = diff(f_expr, x)
print(df_expr)

df = lambdify([x], df_expr)

"""Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Ñ€Ð°Ð½ÐµÐµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ `newton` Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚Ðµ ÐºÐ¾Ñ€Ð½Ð¸ ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð¾ 9 Ð·Ð½Ð°ÐºÐ¾Ð² Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹. 

Ð’ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ð¹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð¾Ð´Ð° Ð´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ð¿Ð¾Ð¿Ð¾Ð»Ð°Ð¼ Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð¾ 2 Ð·Ð½Ð°ÐºÐ¾Ð² Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹.
"""

x0_1, _, _ = bisection(f, a1, b1)# ÐÐ°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° [a1, b1]
x0_2, _, _ = bisection(f, a2, b2)# ÐÐ°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° [a2, b2]

x0_1, x0_2

x1, _, _ = newton(f, df, x0_1) 
x2, _, _ = newton(f, df, x0_2) 

[x1, x2]

"""Ð¡Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ, Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ð² Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ $ð‘“(ð‘¥)$ Ð´Ð»Ñ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ¾Ñ€Ð½ÐµÐ¹. ÐŸÐ¾ÐºÐ°Ð¶Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð±Ð»Ð¸Ð·ÐºÐ¸ Ðº Ð½ÑƒÐ»ÑŽ."""

f(x1), f(x2)

"""#### Ð˜Ð·ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÐÑŒÑŽÑ‚Ð¾Ð½Ð°

Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÐºÐ¾Ð´ Ð¸Ð· ÑÑ‡ÐµÐ¹ÐºÐ¸ Ð½Ð¸Ð¶Ðµ. ÐŸÑ€Ð¸ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð¹ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ `newton` Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚ÑÑ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÐÑŒÑŽÑ‚Ð¾Ð½Ð°.

ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð¼ÐµÑ‚Ð¾Ð´Ð° ÐÑŒÑŽÑ‚Ð¾Ð½Ð° Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ð¾. ÐŸÑ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ðµ `x0`.
"""

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np

from matplotlib import rc
rc('animation', html='jshtml')
plt.rcParams['figure.figsize'] = [12, 8]

fig, ax = plt.subplots()

x0 = b # Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶ÐµÐ½Ð¸Ðµ

x, n, x_list = newton(f, df, x0, 10e-3)

xx = np.arange(min(x_list), max(x_list), 10e-4)
yy = np.vectorize(f)(xx)
ax.plot(xx, yy, 'b')

ax.axhline(y = 0, color = 'k')
ax.plot([x0, x0], [0, f(x0)], 'r:')

def animate(i):
  prev, cur = x_list[i], x_list[i + 1]
  ax.plot([prev, cur], [f(prev), 0], 'r') # Ñ€Ð¸ÑÑƒÐµÐ¼ ÐºÐ°ÑÐ°Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ
  ax.plot([cur, cur], [0, f(cur)], 'r:')
  ax.plot(cur, f(cur), 'ro')

animation.FuncAnimation(fig, animate, frames=n)
