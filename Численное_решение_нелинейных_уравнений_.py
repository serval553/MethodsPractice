# -*- coding: utf-8 -*-
"""–ö–æ–ø–∏—è –±–ª–æ–∫–Ω–æ—Ç–∞ "2. –ß–∏—Å–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π"

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1fiND5GSAx1Yh1Sd6Q1iitZhjJxSomoSo

# –ß–∏—Å–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π - —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–∞:
\begin{align}
& f(x) = 0 \\
\end{align}

–ü—É—Å—Ç—å –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ—Ä–Ω–∏ —ç—Ç–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è.

–ü—Ä–æ—Ü–µ—Å—Å —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ 2 —ç—Ç–∞–ø–∞:
1. –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä–Ω–µ–π, —Ç–æ –µ—Å—Ç—å –ø–æ–∏—Å–∫ –æ—Ç—Ä–µ–∑–∫–æ–≤ $[a, b]$, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–º–µ–µ—Ç —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –∫–æ—Ä–µ–Ω—å. –î–∞–Ω–Ω—ã–π —ç—Ç–∞–ø –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –º–µ—Ç–æ–¥–∞–º–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∑–Ω–∞—á–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –∏ —Ç.–ø.
2. –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–π, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã–º –æ—Ç—Ä–µ–∑–∫–∞–º, —Å —Ç—Ä–µ–±—É–µ–º–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é $\epsilon$. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è $x$ –¥–æ–ª–∂–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ç–æ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è $x_0$ –Ω–µ –±–æ–ª–µ–µ, —á–µ–º –Ω–∞ $\epsilon$:
\begin{align}
& |x - x_0| \le \epsilon \\
\end{align}

## –ú–µ—Ç–æ–¥ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º (–º–µ—Ç–æ–¥ –±–∏—Å–µ–∫—Ü–∏–∏)

–ò–¥–µ—è –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏—Å—Å–ª–µ–¥—É–µ—Ç—Å—è –∑–Ω–∞–∫ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –æ—Ç—Ä–µ–∑–∫–∞ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å–æ –∑–Ω–∞–∫–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –æ—Ç—Ä–µ–∑–∫–∞. –ö–∞–∂–¥–æ–µ —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∏—â–µ—Ç—Å—è –≤ —Ç–æ–º –æ—Ç—Ä–µ–∑–∫–µ, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–Ω–∞–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –æ—Ç–ª–∏—á–∞—é—Ç—Å—è.

–ì–æ–≤–æ—Ä—è —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –æ–±–æ–∑–Ω–∞—á–∏–º –æ—Ç—Ä–µ–∑–æ–∫ –Ω–∞ $i$-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π $[a_i, b_i]$.
–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞ –≤—ã–±–∏—Ä–∞–µ–º –æ—Ç—Ä–µ–∑–æ–∫ $[a, b]$, —Ç–æ –µ—Å—Ç—å: 
\begin{align}
[a_0, b_0] = [a, b],\quad f(a)f(b) < 0
\end{align}
–¢–æ–≥–¥–∞ $i$-–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä–µ–¥–∏–Ω–æ–π $i$-–≥–æ –æ—Ç—Ä–µ–∑–∫–∞:
\begin{align}
x_i = \frac{a_i+b_i}{2}
\end{align}
–°–ª–µ–¥—É—é—â–∏–π –æ—Ç—Ä–µ–∑–æ–∫ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
\begin{align}
[a_{i+1}, b_{i+1}] = 
\begin{cases}
[a_i, x_i], & f(a_i)f(x_i) < 0 \\
[x_i, b_i], & f(x_i)f(b_i) < 0 \\
\end{cases}
\end{align}
–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞
\begin{align}
& |x_i - x_{i - 1}| > \epsilon \\
\end{align}
–≠—Ç–æ —É—Å–ª–æ–≤–∏–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤ –≤–∏–¥–µ:
\begin{align}
& b_i - a_i > 2 \epsilon \\
\end{align}

–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª–∏–Ω–∞ $i$-–≥–æ –æ—Ç—Ä–µ–∑–∫–∞ —Ä–∞–≤–Ω–∞:
\begin{align}
b_i - a_i = \frac{b - a}{2^i}
\end{align}

–û—Ç—Å—é–¥–∞ –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Ñ–æ—Ä–º—É–ª—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Ç–µ—Ä–∞—Ü–∏–∏ $N$, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é $\epsilon$. –£—Å–ª–æ–≤–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–º–µ—Ç –≤–∏–¥:
\begin{align}
\frac{b - a}{2^N} \le 2 \epsilon
\end{align}
–û—Ç—Å—é–¥–∞:
\begin{align}
& N \ge log_2{\frac{b - a}{2\epsilon}} \\
& N = \Big\lceil log_2{\frac{b - a}{2\epsilon}} \Big\rceil \\
\end{align}

### –ó–∞–¥–∞–Ω–∏–µ

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `bisection(f, a, b, eps)`, –Ω–∞—Ö–æ–¥—è—é—â—É—é —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è $f(x) = 0$ –≤ –æ—Ç—Ä–µ–∑–∫–µ $[a, b]$ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é $\epsilon$ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏: 
* `f` - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –æ–¥–Ω–æ–≥–æ —á–∏—Å–ª–æ–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞;
* `a` - –Ω–∞—á–∞–ª–æ –æ—Ç—Ä–µ–∑–∫–∞
* `b` - –∫–æ–Ω–µ—Ü –æ—Ç—Ä–µ–∑–∫–∞
* `eps` - —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è

–§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 3 –∑–Ω–∞—á–µ–Ω–∏—è:
* –∏—Å–∫–æ–º–æ–µ —á–∏—Å–ª–æ $x$
* –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–æ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ
* —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π $x$ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
"""

def bisection(f, a, b, eps = 10e-9):
  x = 0
  n = 0
  x_list = []

  fa, fb = f(a), f(b)
  while b - a > 2 * eps:
    n += 1
    x = (a + b) / 2
    x_list.append(x)
    fx = f(x)
    if fa * fx < 0:
      b = x
      fb = fx
    elif fb * fx < 0:
      a = x
      fa = fx
    else:
      break

  return x, n, x_list

"""#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º

–° –ø–æ–º–æ—â—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–π–¥–∏—Ç–µ –≤—Å–µ –∫–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è (3 –∫–æ—Ä–Ω—è, –µ—Å–ª–∏ –∏—Ö –±–æ–ª—å—à–µ)

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**

\begin{align}
& 1. \quad e^{2x}\sin{x} = \cos{x} \\
& 2. \quad x^3 = \sin{x} \\
& 3. \quad x^3e^{x}\cos{x} = 0 \\
& 4. \quad x^2 \sin{x} + \ln{x} = 0 \\
& 5. \quad \ln{x} + 3 = x^2 \\
& 6. \quad 3x - x^3 = \sin{x} \\
& 7. \quad x^2 \sin{x} + \cos{x^2} = 0 \\
& 8. \quad \cos{x^2} = x \sin{x} \\
& 9. \quad x^2\cos{x^2}+e^x\ln{x} = 0 \\
& 10. \quad x^3\ln{x}+\cos{x} = 2 \\
& 11. \quad e^{4x}\cos{3x}+x^2 = 0 \\
& 12. \quad x^3e^{-x}+\sin{x^3} = 0 \\
\end{align}
"""

import math
def f(x):
  return math.exp(2*x) * math.sin(x) - math.cos(x)

"""–° –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `matplotlib` –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ —Ñ—É–Ω–∫—Ü–∏–∏ $f(x)$"""

import matplotlib
import matplotlib.pyplot as plt
import numpy as np

plt.rcParams['figure.figsize'] = [12, 8]

funk = np.vectorize(f)

fig, ax = plt.subplots()
xx = np.arange(-1, 1, 0.001)
yy = funk(xx)
ax.plot(xx, yy, 'b')
ax.axhline(y = 0, color = 'k')
plt.show()

"""–ü–æ –≥—Ä–∞—Ñ–∏–∫—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –æ—Ç—Ä–µ–∑–∫–∏ $[a, b]$, –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–æ–Ω—Ü–∞—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞–∫–∏."""

a1 = -1.8
b1 = -1.4
print(f(a1)*f(b1) < 0)

a2 = 0
b2 = 1
print(f(a2)*f(b2) < 0)

"""–° –ø–æ–º–æ—â—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–Ω–µ–µ —Ñ—É–Ω–∫—Ü–∏–∏ `bisection` –≤—ã—á–∏—Å–ª–∏—Ç–µ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 9 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π –∫–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –æ—Ç—Ä–µ–∑–∫–∞—Ö"""

x1, _, _ = bisection(f, a1, b1) 
x2, _, _ = bisection(f, a2, b2)

[x1, x2]

"""–°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É, –≤—ã—á–∏—Å–ª–∏–≤ –∑–Ω–∞—á–µ–Ω–∏—è $f(x)$ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π. –ü–æ–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏ –∫ –Ω—É–ª—é."""

print(f(x1))
print(f(x2))

"""#### –ò–∑—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º

–° –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `matplotlib` –∞–Ω–∏–º–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–∑ –∫–æ—Ä–Ω–µ–π –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ —Ç—Ä–µ—Ç—å–µ–≥–æ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
"""

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np

from matplotlib import rc
rc('animation', html='jshtml')

plt.rcParams['figure.figsize'] = [12, 8]

a = a1
b = b1
_, n, x_list = bisection(f, a, b, 10e-3)

fig, ax = plt.subplots()

ax.axhline(y = 0, color = 'k')

ax.plot([a, a], [0, f(a)], 'r:')
ax.plot([b, b], [0, f(b)], 'r:')

# –í–∞—à –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ [a, b] —Å —à–∞–≥–æ–º 0.01 
xx = np.arange(-1, 1, 0.01)
yy = funk(xx)
ax.plot(xx, yy, 'b')
ax.axhline(y = 0, color = 'k')
plt.show()
# –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –µ–≥–æ —Å–∏–Ω–∏–º —Ü–≤–µ—Ç–æ–º ('b')

def animate(i):
  """
  –§—É–Ω–∫—Ü–∏—è animate —Ä–∏—Å—É–µ—Ç —Ç–æ—á–∫—É –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –≤ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
  """
  x_i = x_list[i] # –í–∞—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ i-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
  f_i = f(x_i)
  ax.plot([x_i, x_i], [0, f_i], 'r:')
  ax.plot(x_i, f_i, 'ro')

animation.FuncAnimation(fig, animate, frames=n)

"""##  –ú–µ—Ç–æ–¥ —Å–µ–∫—É—â–∏—Ö

–ò–¥–µ—è –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–∏—Ö —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π –∫ –∫–æ—Ä–Ω—é —É—Ä–∞–≤–Ω–µ–Ω–∏—è –±–µ—Ä—É—Ç—Å—è —Ç–æ—á–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Ö–æ—Ä–¥ —Å –æ—Å—å—é –∞–±—Å—Ü–∏—Å—Å.

–û–±–æ–∑–Ω–∞—á–∏–º —Ç–æ—á–∫—É $C_i(x_i; f(x_i))$. –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è —Ö–æ—Ä–¥–∞ $C_iC_{i-1}$. –ù–∞–π–¥–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–æ—Ä–¥—ã $C_iC_{i-1}$ –≤ –≤–∏–¥–µ $y=kx+b$.

\begin{cases}
f(x_i)=kx_i+b \\
f(x_{i-1})=kx_{i-1}+b
\end{cases}

–ò–∑ —Å–∏—Å—Ç–µ–º—ã –Ω–∞—Ö–æ–¥–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã $k$ –∏ $b$:
\begin{align}
& k = \frac{f(x_i)-f(x_{i-1})}{x_i - x_{i-1}} \\
& b = \frac{x_if(x_{i-1})-x_{i-1}f(x_i)}{x_i - x_{i-1}} \\
\end{align}

–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–æ—Ä–¥—ã –ø—Ä–∏–º–µ—Ç –≤–∏–¥:
\begin{align}
y = x \frac{f(x_i)-f(x_{i-1})}{x_i - x_{i-1}} + \frac{x_if(x_{i-1})-x_{i-1}f(x_i)}{x_i - x_{i-1}}
\end{align}

–í –∫–∞—á–µ—Å—Ç–≤–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è –±–µ—Ä–µ—Ç—Å—è —Ç–æ—á–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Ö–æ—Ä–¥—ã $C_iC_{i-1}$ —Å –æ—Å—å—é –∞–±—Å—Ü–∏—Å—Å ($y = 0$):
\begin{align}
x_{i+1} = \frac{x_{i-1}f(x_i)-x_if(x_{i-1})}{f(x_i)-f(x_{i-1})}
\end{align}

–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ $|x_i - x_{i-1}| \gt \epsilon$

### –ó–∞–¥–∞–Ω–∏–µ

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `secant(f, x1, x2, eps, max_iter)`, –Ω–∞—Ö–æ–¥—è—é—â—É—é —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è $ùëì(ùë•)=0$ c –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è–º–∏ $x_1$ –∏ $x_2$ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é $\epsilon$ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏: 
* `f` - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –æ–¥–Ω–æ–≥–æ —á–∏—Å–ª–æ–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞;
* `x1` - –ø–µ—Ä–≤–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
* `x2` - –≤—Ç–æ—Ä–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
* `eps` - —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è
* `max_iter` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 3 –∑–Ω–∞—á–µ–Ω–∏—è:
* –∏—Å–∫–æ–º–æ–µ —á–∏—Å–ª–æ $x$
* –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–æ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ
* —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π $x$ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
"""

def secant(f, x1, x2, eps=10e-9, max_iter=100):
  x = 0
  n = 0
  x_list = [x1, x2]
  f1 = f(x1)
  f2 = f(x2)

  while abs(x2-x1) > eps and n < max_iter:
    n+= 1
    x = (x1 * f2 - x2* f1) / (f2 - f1)
    x_list.append(x)
    x1, x2 = x2, x
    f1, f2 = f2, f(x)

  return x, n, x_list

"""#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π

–° –ø–æ–º–æ—â—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–Ω–µ–µ —Ñ—É–Ω–∫—Ü–∏–∏ `secant` –≤—ã—á–∏—Å–ª–∏—Ç–µ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 9 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π –∫–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞—Ö, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –º–µ—Ç–æ–¥–µ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º
"""

x1, _, _ = secant(f, a1, b1) 
x2, _, _ = secant(f, a2, b2)

[x1, x2]

"""–°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É, –≤—ã—á–∏—Å–ª–∏–≤ –∑–Ω–∞—á–µ–Ω–∏—è $f(x)$ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π. –ü–æ–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏ –∫ –Ω—É–ª—é."""

f(x1)
f(x2)

"""#### –ò–∑—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–¥ –∏–∑ —è—á–µ–π–∫–∏ –Ω–∏–∂–µ. –ü—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `secant` –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π.

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π –ø–æ—à–∞–≥–æ–≤–æ.
"""

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np

from matplotlib import rc
rc('animation', html='jshtml')
plt.rcParams['figure.figsize'] = [12, 8]

a = a1
b = b1
_, n, x_list = secant(f, a, b, 10e-3)

fig, ax = plt.subplots()

ax.axhline(y = 0, color = 'k')
ax.plot([a, a], [0, f(a)], 'r:')
ax.plot([b, b], [0, f(b)], 'r:')

xx = np.arange(a, b, 10e-4)
yy = np.vectorize(f)(xx)
ax.plot(xx, yy, 'b')

def animate(i):
  """
  –§—É–Ω–∫—Ü–∏—è animate –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ä–∏—Å—É–µ—Ç —Ö–æ—Ä–¥—É –∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
  """
  i += 2 # –ø—Ä–∏–±–∞–≤–ª—è–µ–º 2, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–≤–∞ –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è
  x1, x2 = x_list[i - 2 : i]
  ax.plot([x1, x2, x_list[i]], [f(x1), f(x2), 0], 'r') # —Ä–∏—Å—É–µ–º —Ö–æ—Ä–¥—É
  ax.plot([x_list[i], x_list[i]], [0, f(x_list[i])], 'r:')
  ax.plot(x_list[i], f(x_list[i]), 'ro')

animation.FuncAnimation(fig, animate, frames=n)

"""## –ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ (–º–µ—Ç–æ–¥ –∫–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö)

–ò–¥–µ—è –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ –º–µ—Ç–æ–¥—É —Å–µ–∫—É—â–∏—Ö. –û–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –≤–º–µ—Å—Ç–æ —Ö–æ—Ä–¥—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—Å–∞—Ç–µ–ª—å–Ω–∞—è –∫ –≥—Ä–∞—Ñ–∏–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–æ—á–∫–µ, –∞–±—Å—Ü–∏—Å—Å–∞ –∫–æ—Ç–æ—Ä–æ–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ.

–ó–∞–ø–∏—à–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–π –∫ –≥—Ä–∞—Ñ–∏–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–æ—á–∫–µ $(x_i, f(x_i))$. –ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–æ—á–∫–µ -- —ç—Ç–æ —Ç–∞–Ω–≥–µ–Ω—Å —É–≥–ª–∞ –Ω–∞–∫–ª–æ–Ω–∞ –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–π –∫ –≥—Ä–∞—Ñ–∏–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —ç—Ç–æ–π —Ç–æ—á–∫–µ, —Ç–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –≤ –≤–∏–¥–µ:
\begin{align}
y = f'(x_i) (x - x_i) + f(x_i)
\end{align}

–í –∫–∞—á–µ—Å—Ç–≤–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è –±–µ—Ä–µ—Ç—Å—è —Ç–æ—á–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–π —Å –æ—Å—å—é –∞–±—Å—Ü–∏—Å—Å ($y = 0$):
\begin{align}
x_{i+1} = x_i - \frac{f(x_i)}{f'(x_i)}
\end{align}

–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ $|x_i - x_{i-1}| \gt \epsilon$

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –∫ –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –í—ã—á–∏—Å–ª—è—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç–µ–ª—å–Ω—ã–º –≤ —Å–ª—É—á–∞–µ —Å–ª–æ–∂–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ $f(x)$. 

–ù–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ SymPy, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å–∏–º–≤–æ–ª—å–Ω—ã–µ (–∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ) –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. –ö–æ–¥ –≤ —è—á–µ–π–∫–µ –Ω–∏–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏ $f(x) = x \sin{x}$
"""

from sympy import *

x = symbols('x') # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º x –∫–∞–∫ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª
f_expr = x * sin(x) # –ø–æ–ª—É—á–∞–µ–º —Å–∏–º–≤–æ–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å —Ñ—É–Ω–∫—Ü–∏–∏ f
df_expr = diff(f_expr, x) # –≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Å–∏–º–≤–æ–ª—å–Ω–æ–º –≤–∏–¥–µ
print(df_expr)

# –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å–∏–º–≤–æ–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –≤ Python-—Ñ—É–Ω–∫—Ü–∏—é
df = lambdify([x], df_expr) 
df(5)

"""### –ó–∞–¥–∞–Ω–∏–µ

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `newton(f, df, x0, eps, max_iter)`, –Ω–∞—Ö–æ–¥—è—é—â—É—é —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è $ùëì(ùë•)=0$ c –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è–º–∏ $x_1$ –∏ $x_2$ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é $\epsilon$ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ —Å–µ–∫—É—â–µ–π.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏: 
* `f` - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –æ–¥–Ω–æ–≥–æ —á–∏—Å–ª–æ–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞;
* `df` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã—á–∏—Å–ª—è—é—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏ $f(x)$ –≤ —Ç–æ—á–∫–µ;
* `x0` - –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ;
* `eps` - —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è.

–§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 3 –∑–Ω–∞—á–µ–Ω–∏—è:
* –∏—Å–∫–æ–º–æ–µ —á–∏—Å–ª–æ $x$;
* –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–æ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ;
* —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π $x$ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
"""

def newton(f, df, x0, eps=10e-9, max_iter=100):
  x = x0 + f(x0) / df(x0)
  n = 1
  x_list = [x0, x]
  # –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞
  while abs(x - x0) > eps and n < max_iter:
    n += 1
    x0 = x
    x = x0 + f(x0) / df(x0)
    x_list.append(x)

  return x, n, x_list

"""#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

–° –ø–æ–º–æ—â—å—é SymPy –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏ $f(x)$ –¥–ª—è —Å–≤–æ–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞.
"""

from sympy import *

x = symbols('x')

# –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Å–∏–º–≤–æ–ª—å–Ω–æ–º –≤–∏–¥–µ
# –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª–æ–∂–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é df_expr
x = symbols('x')
f_expr = exp(2*x) * sin(x) - cos(x)
df_expr = diff(f_expr, x)
print(df_expr)

df = lambdify([x], df_expr)

"""–° –ø–æ–º–æ—â—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–Ω–µ–µ —Ñ—É–Ω–∫—Ü–∏–∏ `newton` –≤—ã—á–∏—Å–ª–∏—Ç–µ –∫–æ—Ä–Ω–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 9 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. 

–í –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–∞ –¥–µ–ª–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–∞ –ø–æ–ø–æ–ª–∞–º —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.
"""

x0_1, _, _ = bisection(f, a1, b1)# –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç—Ä–µ–∑–∫–∞ [a1, b1]
x0_2, _, _ = bisection(f, a2, b2)# –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç—Ä–µ–∑–∫–∞ [a2, b2]

x0_1, x0_2

x1, _, _ = newton(f, df, x0_1) 
x2, _, _ = newton(f, df, x0_2) 

[x1, x2]

"""–°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É, –≤—ã—á–∏—Å–ª–∏–≤ –∑–Ω–∞—á–µ–Ω–∏—è $ùëì(ùë•)$ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π. –ü–æ–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏ –∫ –Ω—É–ª—é."""

f(x1), f(x2)

"""#### –ò–∑—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–¥ –∏–∑ —è—á–µ–π–∫–∏ –Ω–∏–∂–µ. –ü—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `newton` –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞.

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –ø–æ—à–∞–≥–æ–≤–æ. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ `x0`.
"""

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np

from matplotlib import rc
rc('animation', html='jshtml')
plt.rcParams['figure.figsize'] = [12, 8]

fig, ax = plt.subplots()

x0 = b # –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ

x, n, x_list = newton(f, df, x0, 10e-3)

xx = np.arange(min(x_list), max(x_list), 10e-4)
yy = np.vectorize(f)(xx)
ax.plot(xx, yy, 'b')

ax.axhline(y = 0, color = 'k')
ax.plot([x0, x0], [0, f(x0)], 'r:')

def animate(i):
  prev, cur = x_list[i], x_list[i + 1]
  ax.plot([prev, cur], [f(prev), 0], 'r') # —Ä–∏—Å—É–µ–º –∫–∞—Å–∞—Ç–µ–ª—å–Ω—É—é
  ax.plot([cur, cur], [0, f(cur)], 'r:')
  ax.plot(cur, f(cur), 'ro')

animation.FuncAnimation(fig, animate, frames=n)